<%
// Meta tags base helper functions
function truncateTitle(title) {
  return title.length > 60 ? title.slice(0, 57) + '...' : title;
}

function truncateDescription(desc) {
  return desc.length > 160 ? desc.slice(0, 157) + '...' : desc;
}

function generateDynamicKeywords(keywords, serviceType) {
  // Convert keywords to array if it's a string
  const keywordArray = typeof keywords === 'string' ? keywords.split(', ') : keywords;

  // Add additional keywords and join
  const allKeywords = [...keywordArray, serviceType, 'security', 'guards', 'California', 'professional'];

  return allKeywords.join(', ');
}
%>

<!-- Performance and Accessibility Best Practices -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preconnect" href="https://www.google-analytics.com" crossorigin>
<link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>
<link rel="preconnect" href="https://connect.facebook.net" crossorigin>
<link rel="dns-prefetch" href="https://stackpath.bootstrapcdn.com">
<link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">

<!-- Base Meta Tags -->
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark">
<meta name="format-detection" content="telephone=no">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<%
// Service data with fallbacks
const serviceData = (typeof locals !== 'undefined' && locals.serviceData) ? locals.serviceData : {};
const {
  serviceTitle = 'Professional Security Services',
  serviceDescription = 'Professional security services with licensed guards and 24/7 monitoring.',
  serviceKeywords = 'security services, security guards',
  serviceType = 'security',
  priceRange = { low: 35, mid: 55, high: 85 }
} = serviceData;

const optimizedTitle = truncateTitle(`${serviceTitle} | 24/7 Guards from $${priceRange.low}/hr`);
const optimizedDescription = truncateDescription(`${serviceDescription} Licensed BSIS guards, 24/7 monitoring, access control & emergency response. 4.9★ (287+ reviews). Call 1-800-SHIELD-1.`);
const optimizedKeywords = generateDynamicKeywords(serviceKeywords, serviceType);
%>

<!-- Essential Meta Tags for 2025 SEO Excellence -->
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Core SEO Meta Tags -->
<title><%= optimizedTitle %></title>
<meta name="description" content="<%= optimizedDescription %>">
<meta name="keywords" content="<%= optimizedKeywords %>">

<!-- Advanced SEO Meta Tags -->
<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
<meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
<meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">

<!-- AI Search Optimization Meta Tags -->
<meta name="ai-search-intent" content="Find professional <%= serviceType %> security services in California">
<meta name="ai-search-service" content="<%= serviceType %> security guards, access control systems, mobile patrols, CCTV monitoring">
<meta name="ai-search-price" content="From $<%= priceRange.low %>/hour, Affordable, Licensed">
<meta name="ai-search-benefit" content="Crime reduction, 24/7 protection, property value increase, enhanced safety">
<meta name="ai-content-type" content="Business, Security Services">
<meta name="ai-search-entity" content="ShieldWise Security Services">
<meta name="ai-search-location" content="California, Los Angeles, San Francisco, San Diego, Orange County, Sacramento">
<meta name="ai-search-differentiator" content="BSIS licensed, 20+ years experience, 287+ verified reviews, $2M liability coverage">

<!-- Content Classification -->
<meta name="content-language" content="en-US">
<meta name="language" content="English">
<meta name="author" content="ShieldWise Security Services">
<meta name="publisher" content="ShieldWise Security Services">
<meta name="copyright" content="© 2025 ShieldWise Security Services. All rights reserved.">
<meta name="rating" content="general">
<meta name="distribution" content="global">
<meta name="revisit-after" content="7 days">

<!-- Geographic Meta Tags -->
<meta name="geo.region" content="US-CA">
<meta name="geo.placename" content="California">
<meta name="geo.position" content="34.052235;-118.243683">
<meta name="ICBM" content="34.052235, -118.243683">

<!-- Format Detection -->
<meta name="format-detection" content="telephone=yes, email=yes, address=yes">

<!-- Security Headers -->
<meta http-equiv="Content-Security-Policy" content="
  default-src 'self';
  script-src 'self' 'unsafe-inline'
    https://www.googletagmanager.com
    https://www.google-analytics.com
    https://connect.facebook.net
    https://cdn.jsdelivr.net
    https://code.jquery.com
    https://stackpath.bootstrapcdn.com;
  style-src 'self' 'unsafe-inline'
    https://fonts.googleapis.com
    https://cdn.jsdelivr.net
    https://stackpath.bootstrapcdn.com
    https://cdnjs.cloudflare.com;
  font-src 'self'
    https://fonts.gstatic.com
    https://cdnjs.cloudflare.com;
  img-src 'self' data: https:;
  connect-src 'self' https://www.google-analytics.com;
  frame-src https://www.google.com https://www.google.com/maps;
  upgrade-insecure-requests;">
<meta http-equiv="Strict-Transport-Security" content="max-age=31536000; includeSubDomains; preload">
<meta http-equiv="X-Content-Type-Options" content="nosniff">
<meta http-equiv="X-Frame-Options" content="SAMEORIGIN">
<meta http-equiv="X-XSS-Protection" content="1; mode=block">
<meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
<meta http-equiv="Permissions-Policy" content="geolocation=(), microphone=(), camera=()">

<!-- DNS Prefetch and Preconnect -->
<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="dns-prefetch" href="//www.google-analytics.com">
<link rel="dns-prefetch" href="//www.googletagmanager.com">
<link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preconnect" href="https://www.google-analytics.com" crossorigin>

<!-- Canonical URL -->
<link rel="canonical" href="https://shieldwisesecurity.com<%= typeof pageUrl !== 'undefined' ? pageUrl : '/' %>">

<!-- Hreflang for Multi-Location -->
<link rel="alternate" hreflang="en-us" href="https://shieldwisesecurity.com<%= typeof pageUrl !== 'undefined' ? pageUrl : '/' %>">
<link rel="alternate" hreflang="es-us" href="https://shieldwisesecurity.com/es<%= typeof pageUrl !== 'undefined' ? pageUrl : '/' %>">
<link rel="alternate" hreflang="x-default" href="https://shieldwisesecurity.com<%= typeof pageUrl !== 'undefined' ? pageUrl : '/' %>">

<!-- Site Verification -->
<meta name="google-site-verification" content="your-google-verification-code">
<meta name="facebook-domain-verification" content="your-facebook-verification-code">
<meta name="norton-safeweb-site-verification" content="your-norton-verification-code">
<meta name="yandex-verification" content="your-yandex-verification-code">
<meta name="msvalidate.01" content="your-bing-verification-code">