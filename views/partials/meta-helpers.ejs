<%
// Helper functions
function truncateTitle(title, maxLength = 58) {
  if (!title) return 'Security Services | ShieldWise';
  const suffix = ' | ShieldWise';
  const maxTitleLength = maxLength - suffix.length;
  return title.length > maxTitleLength ? title.substring(0, maxTitleLength).trim() + '...' + suffix : title + suffix;
}

function truncateDescription(desc, maxLength = 155) {
  if (!desc) return 'Professional security services in California. BSIS licensed guards, 24/7 monitoring. Call 1-800-SHIELD-1 for free assessment.';
  return desc.length > maxLength ? desc.substring(0, maxLength).trim() + '...' : desc;
}

function generateDynamicKeywords(baseKeywords, serviceType, location = 'California') {
  const base = baseKeywords || '';
  const dynamic = `${serviceType} security, ${location} security company, licensed security guards, 24/7 security services`;
  return base + (base ? ', ' : '') + dynamic;
}

// Extract serviceData from locals or use defaults
const serviceDataFromLocals = (typeof locals !== 'undefined' && locals.serviceData) ? locals.serviceData : {};

const {
  serviceTitle = 'Professional Security Services',
  serviceDescription = 'Professional security services with licensed guards and 24/7 monitoring.',
  serviceKeywords = 'security services, security guards',
  serviceImage = 'default-security-service.webp',
  serviceUrl = 'security-services',
  serviceType = 'security',
  serviceBenefit = 'enhanced protection and peace of mind',
  propertyType = 'property',
  priceRange = { low: 35, mid: 55, high: 85 },
  serviceAltName = 'Security Guard Services',
  serviceOutput = 'Enhanced security and protection',
  audienceType = 'Property Managers and Business Owners'
} = serviceDataFromLocals;

const safeServiceData = {
  serviceTitle,
  serviceDescription,
  serviceKeywords,
  serviceImage,
  serviceUrl,
  serviceType,
  serviceBenefit,
  propertyType,
  priceRange,
  serviceAltName,
  serviceOutput,
  audienceType
};
%>