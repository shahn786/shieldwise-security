
<%
// Helper function: truncateTitle
function truncateTitle(title, maxLength = 58) {
  if (!title) return 'Security Services | ShieldWise';
  const suffix = ' | ShieldWise';
  const maxTitleLength = maxLength - suffix.length;
  if (title.length > maxTitleLength) {
    return title.substring(0, maxTitleLength).trim() + '...' + suffix;
  } else {
    return title + suffix;
  }
}

// Helper function: truncateDescription
function truncateDescription(desc, maxLength = 155) {
  if (!desc) {
    return 'Professional security services in California. BSIS licensed guards, 24/7 monitoring. Call 1-800-SHIELD-1 for free assessment.';
  }
  if (desc.length > maxLength) {
    return desc.substring(0, maxLength).trim() + '...';
  }
  return desc;
}

// Helper function: generateDynamicKeywords
function generateDynamicKeywords(baseKeywords, serviceType, location = 'California') {
  const base = baseKeywords || '';
  const dynamic = `${serviceType} security, ${location} security company, licensed security guards, 24/7 security services`;
  return base + (base ? ', ' : '') + dynamic;
}

// Destructure serviceData if it exists; otherwise use empty object
const {
  serviceTitle,
  serviceDescription,
  serviceKeywords,
  serviceImage,
  serviceUrl,
  serviceType,
  serviceBenefit,
  propertyType,
  priceRange,
  serviceAltName,
  serviceOutput,
  audienceType
} = typeof locals !== 'undefined' && typeof locals.serviceData !== 'undefined' ? locals.serviceData : {};

// Now build a "safeServiceData" object, filling in defaults if any property is missing:
const safeServiceData = {
  serviceTitle:       serviceTitle       || 'Professional Security Services',
  serviceDescription: serviceDescription || 'Professional security services with licensed guards and 24/7 monitoring.',
  serviceKeywords:    serviceKeywords    || 'security services, security guards',
  serviceImage:       serviceImage       || 'default-security-service.webp',
  serviceUrl:         serviceUrl         || 'security-services',
  serviceType:        serviceType        || 'security',
  serviceBenefit:     serviceBenefit     || 'enhanced protection and peace of mind',
  propertyType:       propertyType       || 'property',
  priceRange:         priceRange         || { low: 35, mid: 55, high: 85 },
  serviceAltName:     serviceAltName     || 'Security Guard Services',
  serviceOutput:      serviceOutput      || 'Enhanced security and protection',
  audienceType:       audienceType       || 'Property Managers and Business Owners'
};

// Build optimized Title, Description, and Keywords using our helper functions:
const optimizedTitle = truncateTitle(
  `${safeServiceData.serviceTitle} | 24/7 Guards from $${safeServiceData.priceRange.low}/hr`
);

const optimizedDescription = truncateDescription(
  `${safeServiceData.serviceDescription} Licensed BSIS guards, 24/7 monitoring, access control & emergency response. 4.9★ (287+ reviews). Call 1-800-SHIELD-1.`
);

const optimizedKeywords = generateDynamicKeywords(
  safeServiceData.serviceKeywords,
  safeServiceData.serviceType
);
%>

<!-- Core SEO Meta Tags -->
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">

<title><%= optimizedTitle %></title>
<meta name="description" content="<%= optimizedDescription %>">
<meta name="keywords" content="<%= optimizedKeywords %>">

<!-- Enhanced News Keywords -->
<meta name="news_keywords" content="<%= safeServiceData.serviceType %> security, california security, <%= safeServiceData.propertyType %> protection">

<!-- AI Search Engine Optimization Tags -->
<meta name="ai-search-intent" content="Find professional <%= safeServiceData.serviceType %> security services in California">
<meta name="ai-search-service" content="<%= safeServiceData.serviceType %> security guards, access control systems, mobile patrols, CCTV monitoring">
<meta name="ai-search-price" content="From $<%= safeServiceData.priceRange.low %>/hour, Affordable, Licensed">
<meta name="ai-search-benefit" content="Crime reduction, 24/7 protection, property value increase, <%= safeServiceData.serviceBenefit %>">

<!-- Enhanced Open Graph Meta Tags -->
<meta property="og:title" content="Professional <%= safeServiceData.serviceTitle %> | ShieldWise Security California">
<meta property="og:description" content="Licensed 24/7 <%= safeServiceData.serviceType %> security guards for California. Access control, mobile patrols & emergency response from $<%= safeServiceData.priceRange.low %>/hour. 287+ verified reviews.">
<meta property="og:image" content="https://shieldwisesecurity.com/img/<%= safeServiceData.serviceImage %>">
<meta property="og:image:alt" content="Professional security guard providing <%= safeServiceData.serviceType %> security services">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta property="og:url" content="https://shieldwisesecurity.com/services/<%= safeServiceData.serviceUrl %>">
<meta property="og:type" content="website">
<meta property="og:site_name" content="ShieldWise Security">
<meta property="og:locale" content="en_US">
<meta property="og:locale:alternate" content="es_US">
<meta property="og:price:amount" content="<%= safeServiceData.priceRange.low %>">
<meta property="og:price:currency" content="USD">
<meta property="og:availability" content="instock">
<meta property="og:brand" content="ShieldWise Security">
<meta property="og:phone_number" content="+18007433531">

<!-- Enhanced Twitter Card Meta Tags -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@ShieldWiseSec">
<meta name="twitter:creator" content="@ShieldWiseSec">
<meta name="twitter:title" content="Professional <%= safeServiceData.serviceTitle %> | ShieldWise Security">
<meta name="twitter:description" content="Licensed 24/7 <%= safeServiceData.serviceType %> security guards for California. Access control, mobile patrols & emergency response from $<%= safeServiceData.priceRange.low %>/hour.">
<meta name="twitter:image" content="https://shieldwisesecurity.com/img/<%= safeServiceData.serviceImage %>">
<meta name="twitter:image:alt" content="Professional security guard providing <%= safeServiceData.serviceType %> security services">
<meta name="twitter:label1" content="Location">
<meta name="twitter:data1" content="California">
<meta name="twitter:label2" content="Price">
<meta name="twitter:data2" content="From $<%= safeServiceData.priceRange.low %>/hour">

<!-- SINGLE SOURCE OF TRUTH: Canonical URL & Hreflang -->
<link rel="canonical" href="https://shieldwisesecurity.com/services/<%= safeServiceData.serviceUrl %>">
<link rel="alternate" hreflang="en-us" href="https://shieldwisesecurity.com/services/<%= safeServiceData.serviceUrl %>">
<link rel="alternate" hreflang="es-us" href="https://shieldwisesecurity.com/es/servicios/<%= safeServiceData.serviceUrl %>">
<link rel="alternate" hreflang="x-default" href="https://shieldwisesecurity.com/services/<%= safeServiceData.serviceUrl %>">

<!-- Additional Meta Tags -->
<meta name="format-detection" content="telephone=no">
<meta name="author" content="ShieldWise Security Services">
<meta name="publisher" content="ShieldWise Security Services">
<meta name="copyright" content="© 2025 ShieldWise Security Services. All rights reserved.">
<meta name="rating" content="general">
<meta name="distribution" content="global">
<meta name="revisit-after" content="7 days">
<meta name="web_author" content="ShieldWise Security Services">
<meta name="article:publisher" content="https://www.facebook.com/ShieldWiseSecurity">

<!-- Geographic Meta Tags -->
<meta name="geo.region" content="US-CA">
<meta name="geo.placename" content="California">
<meta name="geo.position" content="34.052235;-118.243683">
<meta name="ICBM" content="34.052235, -118.243683">

<!-- Security & Privacy -->
<meta name="referrer" content="no-referrer-when-downgrade">
<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">

<!-- Language & Region -->
<meta name="language" content="English">
<meta name="content-language" content="en-US">
<meta http-equiv="content-language" content="en-US">

<!-- AI Search Engine Optimization Base Tags -->
<meta name="ai-search-entity" content="ShieldWise Security Services">
<meta name="ai-content-type" content="Business, Security Services">
<meta name="ai-search-location" content="California, Los Angeles, San Francisco, San Diego, Orange County, Sacramento">
<meta name="ai-search-differentiator" content="BSIS licensed, 20+ years experience, 287+ verified reviews, $2M liability coverage">

<!-- Social Media Verification -->
<meta name="google-site-verification" content="abc123xyz789definitelyrealgooglecode">
<meta name="facebook-domain-verification" content="fb456def789realhashcode">
<meta name="norton-safeweb-site-verification" content="norton789xyz456verification">

<!-- Favicon + PWA Meta Icons -->
<link rel="icon" type="image/png" sizes="32x32" href="/img/icons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/img/icons/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/img/icons/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="apple-touch-icon" sizes="180x180" href="/img/icons/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="152x152" href="/img/icons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="120x120" href="/img/icons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="76x76" href="/img/icons/apple-touch-icon-76x76.png">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="apple-mobile-web-app-title" content="ShieldWise">
<meta name="application-name" content="ShieldWise Security">
<meta name="msapplication-TileImage" content="/img/icons/ms-tile-image.png">
<meta name="msapplication-TileColor" content="#2b5797">
<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="theme-color" content="#1a3c64">
<meta name="mobile-web-app-capable" content="yes">
